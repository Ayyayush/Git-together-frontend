# ğŸš€ Lecture 3 â€“ Auth Persistence, Protected Routes & Security (Gittogether)

In this lecture, we solve a **real-world frontend problem** and introduce **proper security handling**.

The focus is on:
- Fixing logout-on-refresh issue
- Protecting routes
- Handling logout
- Adding profile page
- Starting feed architecture
- Making frontend behave like a real production app

---

## â— Problem Observed

Abhi ek major issue tha:

> Page refresh karte hi user **logout ho ja raha tha**

This is **NOT acceptable** in real applications.

Expected user experience:
- Login once
- Refresh page
- Still logged in

---

## ğŸ¤” Why Logout Was Happening on Refresh

Important understanding:

- Redux store is **in-memory**
- Page refresh â†’ Redux state resets
- Auth state was stored only in Redux
- Browser refresh clears frontend memory

But at the same time:
- JWT cookie was **still present**
- Backend still trusted the user

So the issue was **frontend-side**, not backend.

---

## âœ… Correct Solution: Auth Persistence

Correct approach:
- Do NOT trust Redux on refresh
- Always verify auth from backend

Flow:
1. App loads
2. Frontend calls backend endpoint to fetch logged-in user
3. If backend confirms user â†’ restore Redux state
4. If backend denies â†’ logout user

This makes the frontend **backend-driven**, not memory-driven.

---

## ğŸ” Auto-Login on Refresh

This concept is known as:
- Auth persistence
- Session rehydration

Core idea:
> Browser refresh should NOT decide auth state  
> Backend should always decide auth state

This is how real-world apps like LinkedIn, Instagram, and GitHub work.

---

## ğŸ§± Updating Body.jsx for Security

`Body.jsx` is no longer just a layout.

It now acts as a **layout + security guard**.

Responsibilities:
- Check if user is authenticated
- Allow access to protected routes only if logged in
- Redirect unauthenticated users to login

Body becomes a **security gate**, not just a UI wrapper.

---

## ğŸ” Protected Routes

Requirement:
> Agar user login nahi hai, toh protected routes access nahi kar paana chahiye

### Protected routes:
- Feed
- Profile
- Requests

### Public routes:
- Login
- Signup

This ensures:
- No unauthorized access
- Clean and predictable routing
- Strong frontend security

---

## ğŸ›¡ï¸ Security Checks Added

Multiple layers of security are enforced:

- Backend validates JWT on every request
- Frontend validates auth on page load
- Routes are guarded
- UI reacts to authentication state

Security is **layered**, not dependent on a single check.

---

## ğŸšª Logout Flow

Logout is handled cleanly and securely.

Backend:
- Clears HTTP-only JWT cookie

Frontend:
- Clears user data from Redux store
- Redirects user to login page
- UI updates instantly

Logout flow is now:
- Secure
- Predictable
- Production-ready

---

## ğŸ“° Building the Feed (Introduction)

Now we start working on the **Feed system**.

### Feed Requirements:
- Show user cards
- Each card represents a developer
- Tinder-style card UI
- User information is passed as props

To support this:
- A `Feed` page will be created
- A reusable `FeedCard` component will be built
- FeedCard will display:
  - User photo
  - Name
  - Skills
  - About / bio
  - Action buttons (later)

Feed logic will remain **backend-driven**, frontend only renders data.

---

## ğŸ§  Backend Thinking Applied to Frontend

- Redux store â†’ Cache, not source of truth
- Backend â†’ Final authority
- Refresh â†’ Re-verify session
- Layout â†’ Security gate
- Routes â†’ Access-controlled
- Feed â†’ Pure rendering layer

Frontend is treated as a **secure client**, not a trusted one.

---

## ğŸ”¥ Interview-Level Explanation

> â€œRedux state resets on refresh, so I rehydrate authentication by validating the session with the backend using HTTP-only cookies. Protected routes ensure unauthorized users cannot access secure pages.â€

This answer clearly demonstrates **real-world frontend + backend understanding**.

---

## âœ… Lecture 3 Summary

- Identified logout-on-refresh issue
- Understood Redux memory limitation
- Implemented backend-driven auth persistence
- Converted Body.jsx into a security guard
- Protected routes implemented
- Secure logout flow completed
- Profile page integrated
- Feed architecture introduced
- Frontend security significantly improved

---